<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  
  <title>
    
      Introducing TinyCI - Clever Name
    
  </title>
  <meta name="description" content="_____ _ _____ _____ /__ (_)_ __ _ _ / ___/ /_ _/ | || | &#39;_ \| | | |/ / / / | || | | | | |_| / /___/\/ /_ |_||_|_| |_|\__, \____/\____/ |___/ TinyCI is basically a git hook that builds your project and runs your tests when you push a new commit. It’s pitched as a CI system, so a competitor to enormous systems like Circle and Travis. Really though, its much more along the lines of directory watcher scripts like Guard which people use to automatically run their tests whenever they save their files locally. For a full exploration of the architecture and limitations, please see the project’s README.">
  

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="http://0.0.0.0:3000/2018/05/09/Introducing-TinyCI/">
  
  
  <link rel="alternate" type="application/rss+xml" title="Clever Name" href="http://0.0.0.0:3000/feed.xml">

  

  
  <meta name="twitter:card" content="summary">
  
  <meta name="twitter:title" content="">
  <meta name="twitter:description" content="_____ _ _____ _____ /__ (_)_ __ _ _ / ___/ /_ _/ | || | &#39;_ \| | | |/ / / / | || | | | | |_| / /___/\/ /_ |_||_|_| |_|\__, \____/\____/ |___/ TinyCI is basically a git hook that builds your proj...">
  
  

  <link rel="dns-prefetch" href="https://fonts.gstatic.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Bitter:ital,wght@0,400;0,700;1,400&amp;display=swap" rel="stylesheet">

  

</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Clever Name</a>

    <nav class="site-nav">
      
        
        <a class="page-link" href="/archives">Archives</a>
      
        
        <a class="page-link" href="/code">Code</a>
      
        
        <a class="page-link" href="http://unmode.com">Music</a>
      
        
        <a class="page-link" href="mailto:jonnie@cleverna.me">Contact</a>
      
    </nav>

  </div>

</header>


    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    
      <h1 class="post-title" itemprop="name headline">Introducing TinyCI</h1>
    
    <p class="post-meta"><time datetime="2018-05-09T11:39:55+01:00" itemprop="datePublished">May 9, 2018</time> •
  
    
    
  
    
    
  



</p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> _____ _               _____  _____
/__   (_)_ __  _   _  / ___/ /_  _/
   | || | '_ \| | | |/ /     / /
   | || | | | | |_| / /___/\/ /_  
   |_||_|_| |_|\__, \____/\____/
               |___/
</code></pre></div></div>

<p><a href="https://github.com/JonnieCache/tinyci">TinyCI</a> is basically a git hook that builds your project and runs your tests when you push a new commit. It’s pitched as a CI system, so a competitor to enormous systems like <a href="https://circleci.com">Circle</a> and <a href="travis-ci.org">Travis</a>. Really though, its much more along the lines of directory watcher scripts like <a href="https://github.com/guard/guard">Guard</a> which people use to automatically run their tests whenever they save their files locally.</p>

<p>For a full exploration of the architecture and limitations, please see the <a href="https://github.com/JonnieCache/tinyci">project’s README.</a></p>

<!-- more -->

<p>Usually, this leads to the tests being run on a constant rotation, especially if you have your editor set up to automatically save files when it loses focus. This is all good: test early and often as they say. However, eventually you get to the stage of writing heavy integration tests that take a long time to execute, and consume significant resources.</p>

<p>My solution was to exclude the integration tests from my autotester, and to write TinyCI as a sort of autotester for the repo.</p>

<p>This provides several benefits:</p>

<ul>
  <li>
    <p>Heavier tests are only run when I commit, every half hour or so. This seems more appropriate than every 10 seconds when I write the files out to disk.</p>
  </li>
  <li>
    <p>They can be run on a different machine than the underpowered ultraportable you probably use for development these days.</p>
  </li>
  <li>
    <p>You can conveniently run them in a different environment. I run mine on a linux VPS, because this allows me to execute the tests in the same containers as they’re deployed in. I can’t do that at all on my dev machine, because I’m allergic to upgrading OSX and as such I don’t have the hypervisor.</p>
  </li>
</ul>

<p>Why not use a proper CI system? I tried that, but they’re all enormous, hulking things designed for the enterprise. Seriously, look into running your own instance of Travis sometime. Even they advise against it. It would take longer to set the damn thing up than it takes to write most personal projects.</p>

<hr />

<p>TinyCI is written in ruby. It executes as a <code class="language-plaintext highlighter-rouge">post-update</code> hook, and when it runs it looks for all untested commits in the repo. For each of these, in order of commit time, it exports the tree and runs a build script and then a test script, referenced in a config file found in the tree itself. The commit is then tagged with “success” or “failure” using the little-used <a href="https://git-scm.com/docs/git-notes">git-notes</a> functionality.</p>

<p>Once again, for a full exploration of the architecture and limitations, please see the <a href="https://github.com/JonnieCache/tinyci">project’s README.</a></p>

<p>Please let me know of any questions or comments you might have! Hope you find it useful!</p>

  </div>

  

</article>

      </div>
    </main>

    <footer class="site-footer">

  <div class="wrapper">

    <p>
      

&copy;  - Powered by <a href="https://jekyllrb.com">Jekyll</a> &amp; <a href="https://github.com/yous/whiteglass">whiteglass</a> - Subscribe via <a href="http://0.0.0.0:3000/feed.xml">RSS</a>

    </p>

  </div>

</footer>


  </body>

</html>
